<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<title>ğŸ©µğŸ©· å¹¸ç¦æ—¶åˆ» ğŸ©·ğŸ©µ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;}

body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",sans-serif;
  background:linear-gradient(135deg,#4ab7cc 0%,#f2b3c6 100%);
}

/* æ•´ä½“å¸ƒå±€ */
.wrapper{
  display:flex;
  height:100vh;
}

/* å·¦ä¾§ */
.sidebar{
  width:260px;
  background:#fff;
  padding:20px;
  overflow-y:auto;
  box-shadow:3px 0 15px rgba(0,0,0,.08);
  position:fixed;
  left:0;
  top:0;
  bottom:0;
}

.sidebar h2{
  margin:0 0 20px;
  font-size:18px;
}

.year{
  font-weight:bold;
  cursor:pointer;
  margin-top:10px;
}

.month{
  margin-left:15px;
  cursor:pointer;
  color:#666;
  display:none;
  transition:all .3s ease;
}

.month:hover{color:#4ab7cc;}

.day{
  margin-left:30px;
  font-size:14px;
  cursor:pointer;
  display:none;
}

.day:hover{color:#f2b3c6;}

/* å³ä¾§ */
.main{
  margin-left:260px;
  flex:1;
  overflow-y:auto;
  padding:40px;
  scroll-behavior:smooth;
}

.section{
  background:#fff;
  padding:30px;
  border-radius:20px;
  margin-bottom:40px;
  box-shadow:0 12px 35px rgba(0,0,0,.1);
  animation:fadeIn .6s ease;
}

.section h3{
  margin-top:0;
  text-align:center;
}

/* è¿”å›é¦–é¡µ */
.back{
  display:inline-block;
  margin-bottom:20px;
  text-decoration:none;
  color:#ff8fa3;
  font-weight:bold;
}

.back:hover{opacity:.7;}

@keyframes fadeIn{
  from{opacity:0;transform:translateY(10px);}
  to{opacity:1;transform:translateY(0);}
}

/* æ‰‹æœº */
@media(max-width:768px){
  .sidebar{position:relative;width:100%;height:auto;}
  .main{margin-left:0;}
  .wrapper{flex-direction:column;}
}
</style>
</head>

<body>

<div class="wrapper">

  <!-- å·¦ä¾§ -->
  <div class="sidebar">
    <h2>ğŸ©µ æ—¥æœŸç´¢å¼• ğŸ©·</h2>
    <div id="tree"></div>
  </div>

  <!-- å³ä¾§ -->
  <div class="main" id="content">
    <a href=" " class="back">â† è¿”å›é¦–é¡µ</a >
    <div id="posts"></div>
  </div>

</div>

<script>
fetch("diary.json")
  .then(res => res.json())
  .then(list => {

    const treeDiv = document.getElementById("tree");
    const postsDiv = document.getElementById("posts");

    const tree = {};

    // æ„å»ºæ ‘ç»“æ„
    list.forEach(item => {
      const y = item.year;
      const m = item.month;
      const d = item.day;

      if (!tree[y]) tree[y] = {};
      if (!tree[y][m]) tree[y][m] = [];
      tree[y][m].push(item);
    });

    // å¹´ä»½å¾ªç¯
    Object.keys(tree).sort().reverse().forEach(y => {

      const yearDiv = document.createElement("div");
      yearDiv.className = "year";
      yearDiv.textContent = y;
      yearDiv.onclick = () => yearDiv.classList.toggle("open");

      const monthWrap = document.createElement("div");
      monthWrap.className = "month";

      // æœˆä»½å¾ªç¯
      Object.keys(tree[y]).sort().reverse().forEach(m => {

        const monthDiv = document.createElement("div");
        monthDiv.className = "month-title";
        monthDiv.textContent = m;

        const daysDiv = document.createElement("div");
        daysDiv.className = "day";

        tree[y][m]
          .sort((a,b)=>b.day - a.day)
          .forEach(item => {

            const a = document.createElement("a");
            a.textContent = item.day;
            a.href = "#";

            a.onclick = (e)=>{
              e.preventDefault();

              fetch(item.file)
                .then(res=>res.text())
                .then(html=>{
                  postsDiv.innerHTML = `
                    <div class="section">
                      <h3>${item.year}-${item.month}-${item.day}</h3>
                      ${html}
                    </div>
                  `;
                });
            };

            daysDiv.appendChild(a);
          });

        monthDiv.onclick = e=>{
          e.stopPropagation();
          daysDiv.style.display =
            daysDiv.style.display==="block"?"none":"block";
        };

        monthWrap.appendChild(monthDiv);
        monthWrap.appendChild(daysDiv);
      });

      yearDiv.appendChild(monthWrap);
      treeDiv.appendChild(yearDiv);
    });

  });
</script>

  /* é»˜è®¤æ˜¾ç¤ºæœ€æ–° */
  if(list.length>0){
    loadPost(list[0]);
  }

});
</script>
<footer style="text-align:center;font-size:12px;color:#eee;margin:30px 0;">
  Â© 2026 LUMU
</footer>

</body>
</html>
