<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>ğŸ©µğŸ©· å¹¸ç¦æ—¶åˆ» ğŸ©·ğŸ©µ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;margin:0;padding:0;}
html,body{height:100%;}

/* èƒŒæ™¯ */
body{
  font-family:"Smiley Sans",-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",sans-serif;
  background:linear-gradient(135deg,#4ab7cc 0%,#79cbd8 25%,#b7dbe3 50%,#e4cddc 75%,#f2b3c6 100%);
  display:flex;
  overflow:hidden;
}

/* ç²’å­ */
#particles{
  position:fixed; top:0; left:0; width:100%; height:100%;
  pointer-events:none; z-index:0;
}
.particle{
  position:absolute;
  border-radius:50%;
  opacity:0.4;
  animation:float linear infinite;
}
@keyframes float{
  from{transform:translateY(100vh) scale(1);}
  to{transform:translateY(-10vh) scale(1.2);}
}

/* ä¸»ä½“å¸ƒå±€ */
.wrapper{
  display:flex; flex:1; min-height:100vh; z-index:1; position:relative;
}

/* å·¦ä¾§æ—¥æœŸç´¢å¼• */
.sidebar{
  width:260px;
  padding:20px;
  overflow-y:auto;
}
.sidebar h2{color:#fff;margin-bottom:20px;font-size:18px;}
.year, .month, .day{
  background:rgba(255,255,255,0.9);
  border-radius:12px;
  margin:8px 0;
  padding:8px 12px;
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
  cursor:pointer;
}
.month{margin-left:15px;}
.day{margin-left:30px;font-size:14px;}

/* å³ä¾§ç•™è¨€æ¿ */
.main{
  flex:1;
  padding:30px;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
}
.section{
  background:rgba(255,255,255,0.9);
  padding:20px 25px;
  border-radius:18px;
  margin-bottom:20px;
  box-shadow:0 8px 20px rgba(0,0,0,0.08);
  flex-shrink:0;
}
.section h3{margin-bottom:10px;}
.section p{font-size:14px;line-height:1.8;color:#555;}
.section small{display:block;margin-top:6px;color:#4ab7cc;font-weight:600;}
.back{margin-bottom:20px;color:#fff;font-weight:bold;text-decoration:none;}
.back:hover{opacity:.8;}

@media(max-width:768px){
  .wrapper{flex-direction:column;}
  .sidebar{width:100%;height:auto;}
}
</style>
</head>

<body>

<div id="particles"></div>

<div class="wrapper">
  <div class="sidebar">
    <h2>ğŸ©µ æ—¥æœŸç´¢å¼• ğŸ©·</h2>
    <div id="tree"></div>
  </div>

  <div class="main">
    <a href=" " class="back">â† è¿”å›é¦–é¡µ</a >
    <div id="posts"></div>
  </div>
</div>

<script>
/* ğŸŒ¸ ç²’å­ç”Ÿæˆ */
const particleContainer = document.getElementById("particles");
for(let i=0;i<50;i++){
  const p=document.createElement("div");
  p.className="particle";
  const size=Math.random()*6+3;
  p.style.width=size+"px"; p.style.height=size+"px";
  p.style.left=Math.random()*100+"%";
  p.style.background=Math.random()>0.5?"#ffffff":"#ffd1ec";
  p.style.animationDuration=(Math.random()*15+10)+"s";
  p.style.animationDelay=Math.random()*10+"s";
  particleContainer.appendChild(p);
}

/* ğŸŒ¸ Cusdis API è·å–ç•™è¨€ */
const APP_ID = "6bd954b7-e2b4-4206-a1c3-3072cecfc326";
const PAGE_ID = "global-board"; 
const postsDiv = document.getElementById("posts");
const treeDiv = document.getElementById("tree");

async function loadComments(){
  const res = await fetch(`https://cusdis.com/api/open/comments?appId=${APP_ID}&page=1`);
  const data = await res.json();
  const comments = data.data;

  // æŒ‰æ—¥æœŸåˆ†ç±»
  const tree = {};
  comments.forEach(c=>{
    const date = new Date(c.createdAt);
    const y=date.getFullYear();
    const m=String(date.getMonth()+1).padStart(2,'0');
    const d=String(date.getDate()).padStart(2,'0');
    if(!tree[y]) tree[y]={};
    if(!tree[y][m]) tree[y][m]={};
    if(!tree[y][m][d]) tree[y][m][d]=[];
    tree[y][m][d].push({nickname:c.nickname, content:c.content, date:`${y}-${m}-${d}`});
  });

  // æ¸²æŸ“æ ‘çŠ¶ç´¢å¼•
  const sortedYears = Object.keys(tree).sort().reverse();
  sortedYears.forEach(y=>{
    const yearDiv = document.createElement("div");
    yearDiv.className="year"; yearDiv.textContent=y;
    const monthWrap=document.createElement("div");

    yearDiv.onclick=()=>{ monthWrap.style.display = monthWrap.style.display==="block"?"none":"block"; };

    Object.keys(tree[y]).sort().reverse().forEach(m=>{
      const monthDiv=document.createElement("div");
      monthDiv.className="month"; monthDiv.textContent=m;
      const dayWrap=document.createElement("div");

      monthDiv.onclick=(e)=>{ e.stopPropagation(); dayWrap.style.display=dayWrap.style.display==="block"?"none":"block"; };

      Object.keys(tree[y][m]).sort().reverse().forEach(d=>{
        const dayDiv=document.createElement("div");
        dayDiv.className="day"; dayDiv.textContent=d;
        dayDiv.onclick=(e)=>{
          e.stopPropagation();
          showPosts(y,m,d);
        };
        dayWrap.appendChild(dayDiv);
      });

      monthWrap.appendChild(monthDiv);
      monthWrap.appendChild(dayWrap);
    });

    treeDiv.appendChild(yearDiv);
    treeDiv.appendChild(monthWrap);
  });

  // æ˜¾ç¤ºæŸå¤©ç•™è¨€
  function showPosts(y,m,d){
    postsDiv.innerHTML="";
    tree[y][m][d].forEach(item=>{
      postsDiv.innerHTML+=`
        <div class="section">
          <h3>${item.date}</h3>
          <p>${item.content}</p >
          <small>${item.nickname}</small>
        </div>
      `;
    });
  }

  // é»˜è®¤æ˜¾ç¤ºæœ€è¿‘ä¸€å¤©
  const latestY = sortedYears[0];
  const latestM = Object.keys(tree[latestY]).sort().reverse()[0];
  const latestD = Object.keys(tree[latestY][latestM]).sort().reverse()[0];
  showPosts(latestY,latestM,latestD);
}

loadComments();
</script>

</body>
</html>
